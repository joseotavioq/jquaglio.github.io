<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="José Otávio Quaglio" />
  
  <meta name="keywords" content=".NET, ASP.NET, " />
  

  <title>Erro: Chave inválida para uso no estado especificado (ID1073)</title>

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900,100italic,300italic,400italic,500italic,700italic,900italic%7COpen+Sans:300,400,600,700,800,300italic,400italic,600italic,700italic,800italic">
  <link rel="alternate" type="application/rss+xml" title="José Otávio Quaglio" href="/feed.xml">
</head>

<body>

  <header class="site-header" role="banner">
    <div class="wrapper">
      <a class="site-title" href="/">José Otávio Quaglio</a>
      <nav class="site-nav">
        <a href="#" class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z" />
            <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z" />
            <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z" />
          </svg>
        </a>
        <div class="trigger">
          <a class="page-link" href="/">Início</a>
          <a class="page-link" href="/html5game/">HTML5 Game</a>
          <a class="page-link" href="/sobre/">Sobre</a>
        </div>
      </nav>
    </div>
  </header>
  
  <main class="page-content" aria-label="Content">
    <div class="wrapper">

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Erro: Chave inválida para uso no estado especificado (ID1073)</h1>
    <p class="post-meta">
      <time datetime="2014-05-06 11:21:00 -0300" itemprop="datePublished">May 6, 2014</time>
    </p>

    <ul class="post-tags">
    
      <li><a class="post-tag" href="/tags/#.NET">.NET</a></li>
    
      <li><a class="post-tag" href="/tags/#ASP.NET">ASP.NET</a></li>
    
    </ul>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Ao tentar acessar a URL de seu Web Application, você se depara com o seguinte erro?</p>

<p><code class="highlighter-rouge">[CryptographicException: The data is invalid.]</code></p>

<p>(ou “Chave inválida para uso no estado especificado.”)</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">System</span><span class="p">.</span><span class="n">Security</span><span class="p">.</span><span class="n">Cryptography</span><span class="p">.</span><span class="n">ProtectedData</span><span class="p">.</span><span class="nf">Unprotect</span><span class="p">(</span><span class="n">Byte</span><span class="p">[]</span> <span class="n">encryptedData</span><span class="p">,</span> 
    <span class="n">Byte</span><span class="p">[]</span> <span class="n">optionalEntropy</span><span class="p">,</span> <span class="n">DataProtectionScope</span> <span class="n">scope</span><span class="p">)</span> <span class="p">+</span><span class="m">318</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">ProtectedDataCookieTransform</span><span class="p">.</span><span class="nf">Decode</span><span class="p">(</span><span class="n">Byte</span><span class="p">[]</span> <span class="n">encoded</span><span class="p">)</span> <span class="p">+</span><span class="m">203</span></code></pre></figure>

<p><code class="highlighter-rouge">[InvalidOperationException: ID1073: A CryptographicException occurred when attempting to decrypt the cookie using the ProtectedData API (see inner exception for details). If you are using IIS 7.5, this could be due to the loadUserProfile setting on the Application Pool being set to false. ]</code></p>

<p>(ou: “Ocorreu uma CryptographicException ao tentar descriptografar o cookie usando a API ProtectedData (consulte a exceção interna para obter detalhes). Se estiver usando o IIS 7.5, isso pode ser devido à configuração de loadUserProfile no Pool de Aplicativos estar definida como falso.”)</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">ProtectedDataCookieTransform</span><span class="p">.</span><span class="nf">Decode</span><span class="p">(</span><span class="n">Byte</span><span class="p">[]</span> <span class="n">encoded</span><span class="p">)</span> <span class="p">+</span><span class="m">319</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">SessionSecurityTokenHandler</span><span class="p">.</span><span class="nf">ApplyTransforms</span><span class="p">(</span><span class="n">Byte</span><span class="p">[]</span> <span class="n">cookie</span><span class="p">,</span> 
    <span class="n">Boolean</span> <span class="n">outbound</span><span class="p">)</span> <span class="p">+</span><span class="m">217</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">SessionSecurityTokenHandler</span><span class="p">.</span><span class="nf">ReadToken</span><span class="p">(</span><span class="n">XmlReader</span> <span class="n">reader</span><span class="p">,</span> 
    <span class="n">SecurityTokenResolver</span> <span class="n">tokenResolver</span><span class="p">)</span> <span class="p">+</span><span class="m">1951</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">SessionSecurityTokenHandler</span><span class="p">.</span><span class="nf">ReadToken</span><span class="p">(</span><span class="n">Byte</span><span class="p">[]</span> <span class="n">token</span><span class="p">,</span> 
    <span class="n">SecurityTokenResolver</span> <span class="n">tokenResolver</span><span class="p">)</span> <span class="p">+</span><span class="m">149</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">SessionAuthenticationModule</span><span class="p">.</span><span class="nf">ReadSessionTokenFromCookie</span><span class="p">(</span>
    <span class="n">Byte</span><span class="p">[]</span> <span class="n">sessionCookie</span><span class="p">)</span> <span class="p">+</span><span class="m">598</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">SessionAuthenticationModule</span><span class="p">.</span><span class="nf">TryReadSessionTokenFromCookie</span><span class="p">(</span>
    <span class="n">SessionSecurityToken</span><span class="p">&amp;</span> <span class="n">sessionToken</span><span class="p">)</span> <span class="p">+</span><span class="m">120</span>
<span class="n">Microsoft</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">SessionAuthenticationModule</span><span class="p">.</span><span class="nf">OnAuthenticateRequest</span><span class="p">(</span>
    <span class="n">Object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">eventArgs</span><span class="p">)</span> <span class="p">+</span><span class="m">113</span>
<span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">SyncEventExecutionStep</span><span class="p">.</span><span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">HttpApplication</span><span class="p">.</span><span class="n">IExecutionStep</span><span class="p">.</span><span class="nf">Execute</span><span class="p">()</span> <span class="p">+</span><span class="m">136</span>
<span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">HttpApplication</span><span class="p">.</span><span class="nf">ExecuteStep</span><span class="p">(</span><span class="n">IExecutionStep</span> <span class="n">step</span><span class="p">,</span> <span class="n">Boolean</span><span class="p">&amp;</span> <span class="n">completedSynchronously</span><span class="p">)</span> <span class="p">+</span><span class="m">69</span></code></pre></figure>

<blockquote>
  <p>Para resolver este problema remova os cookies do seu browser e tente novamente.</p>
</blockquote>

  </div>
  
  <div>
    <ul class="share-buttons">
      <li><a href="https://www.facebook.com/sharer/sharer.php?u=http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html&t=Erro: Chave inválida para uso no estado especificado (ID1073)" title="Share on Facebook" target="_blank"><img class="share-button" alt="Share on Facebook" src="/images/share/Facebook.png"></a></li>
      <li><a href="https://twitter.com/intent/tweet?source=http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html&text=Erro: Chave inválida para uso no estado especificado (ID1073): http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html" target="_blank" title="Tweet"><img class="share-button" alt="Tweet" src="/images/share/Twitter.png"></a></li>
      <li><a href="https://plus.google.com/share?url=http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html" target="_blank" title="Share on Google+"><img class="share-button" alt="Share on Google+" src="/images/share/Google+.png"></a></li>
      <li><a href="http://pinterest.com/pin/create/button/?url=http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html&description=Erro: Chave inválida para uso no estado especificado (ID1073)" target="_blank" title="Pin it"><img class="share-button" alt="Pin it" src="/images/share/Pinterest.png"></a></li>
      <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html&title=Erro: Chave inválida para uso no estado especificado (ID1073)&summary=&source=http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html" target="_blank" title="Share on LinkedIn"><img class="share-button" alt="Share on LinkedIn" src="/images/share/LinkedIn.png"></a></li>
    </ul>
  </div>
</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_config = function () {
    this.page.url = 'http://www.joseotavio.com/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html';
    this.page.identifier = '/2014/05/06/resolvendo-erro-chave-invalida-para-uso.html';
    this.page.title = 'Erro: Chave inválida para uso no estado especificado (ID1073)';
};
(function() {
    var d = document, s = d.createElement('script');
    s.src = '//joseotavio.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>

    </div>
  </main>
  <footer class="site-footer">
    <div class="wrapper">
      <div class="footer-col-wrapper">
        <div class="footer-col footer-col-1">
          <p class="rss-subscribe"><a href="/feed.xml">RSS</a></p>
        </div>
        <div class="footer-col footer-col-2">
        </div>
        <div class="footer-col footer-col-3">
          <div class="article-tag">
            <div class="tag-item"><div class="tag-item-name">.NET</div><div class="tag-item-count">28</div></div>
<div class="tag-item"><div class="tag-item-name">C#</div><div class="tag-item-count">24</div></div>
<div class="tag-item"><div class="tag-item-name">JavaScript</div><div class="tag-item-count">21</div></div>
<div class="tag-item"><div class="tag-item-name">jQuery</div><div class="tag-item-count">10</div></div>
<div class="tag-item"><div class="tag-item-name">CSS</div><div class="tag-item-count">9</div></div>
<div class="tag-item"><div class="tag-item-name">ASP.NET</div><div class="tag-item-count">9</div></div>
<div class="tag-item"><div class="tag-item-name">WCF</div><div class="tag-item-count">9</div></div>
<div class="tag-item"><div class="tag-item-name">Teste de Unidade</div><div class="tag-item-count">6</div></div>
<div class="tag-item"><div class="tag-item-name">HTML</div><div class="tag-item-count">5</div></div>
<div class="tag-item"><div class="tag-item-name">Objective-C</div><div class="tag-item-count">4</div></div>
<div class="tag-item"><div class="tag-item-name">Web Forms</div><div class="tag-item-count">4</div></div>
<div class="tag-item"><div class="tag-item-name">Visual Studio 2010</div><div class="tag-item-count">4</div></div>
<div class="tag-item"><div class="tag-item-name">Moles</div><div class="tag-item-count">3</div></div>
<div class="tag-item"><div class="tag-item-name">Parse.Framework</div><div class="tag-item-count">3</div></div>
<div class="tag-item"><div class="tag-item-name">Xcode</div><div class="tag-item-count">3</div></div>
<div class="tag-item"><div class="tag-item-name">Mock</div><div class="tag-item-count">2</div></div>
<div class="tag-item"><div class="tag-item-name">jQuery UI</div><div class="tag-item-count">2</div></div>
<div class="tag-item"><div class="tag-item-name">Xamarin</div><div class="tag-item-count">2</div></div>
<div class="tag-item"><div class="tag-item-name">Cloud Code</div><div class="tag-item-count">2</div></div>
<div class="tag-item"><div class="tag-item-name">MVC</div><div class="tag-item-count">2</div></div>
<div class="tag-item"><div class="tag-item-name">WIF</div><div class="tag-item-count">2</div></div>
<div class="tag-item"><div class="tag-item-name">LINQ</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Report Viewer</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">JSON</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Windows Form</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Injeção de Dependência</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Node.js</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Cordova</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Inversão de Controle</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">ASP.NET MVC</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">ASP.NET Core</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">EFCore</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Azure</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Docker</div><div class="tag-item-count">1</div></div>
<div class="tag-item"><div class="tag-item-name">Xunit</div><div class="tag-item-count">1</div></div>

          </div>
        </div>
      </div>
    </div>
  </footer>

  <script id="dsq-count-scr" type="text/javascript" src="//joseotavio.disqus.com/count.js" async></script>
  <script type="text/javascript" src="http://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
  <script type="text/javascript" src="/scripts/main.js"></script>
  <noscript>Seu browser não suporta JavaScript.</noscript>
</body>

</html>